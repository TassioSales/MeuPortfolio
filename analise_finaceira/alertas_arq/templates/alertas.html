{% extends "base.html" %}

{% block title %}Alertas{% endblock %}

{% block content %}
<div class="container mt-4">
    <h1 class="mb-4">Gerenciamento de Alertas</h1>
    
    <div class="card mb-4">
        <div class="card-header">
            <h5 class="mb-0">Criar Novo Alerta</h5>
        </div>
        <div class="card-body">
            <form id="formAlerta">
                <div class="row mb-3">
                    <div class="col-md-6">
                        <label for="tipoAlerta" class="form-label">Tipo de Alerta</label>
                        <select class="form-select" id="tipoAlerta" name="tipoAlerta" required>
                            <option value="">Selecione o tipo de alerta</option>
                            <option value="valor_excedido">Valor Excedido</option>
                            <option value="valor_abaixo">Valor Abaixo</option>
                            <option value="transacao_suspeita">Transação Suspeita</option>
                            <option value="categoria_especifica">Categoria Específica</option>
                        </select>
                    </div>
                    <div class="col-md-6">
                        <label for="descricao" class="form-label">Descrição do Alerta</label>
                        <input type="text" class="form-control" id="descricao" name="descricao" placeholder="Descreva o alerta" required>
                    </div>
                </div>

                <div class="row mb-3">
                    <div class="col-md-6">
                        <label for="valorReferencia" class="form-label">Valor Referência (R$)</label>
                        <div class="input-group">
                            <span class="input-group-text">R$</span>
                            <input type="number" class="form-control" id="valorReferencia" name="valorReferencia" step="0.01" min="0" placeholder="0,00">
                        </div>
                    </div>
                    <div class="col-md-6">
                        <label for="categoria" class="form-label">Categoria</label>
                        <select class="form-select" id="categoria" name="categoria">
                            <option value="">Todas as categorias</option>
                            <option value="alimentacao">Alimentação</option>
                            <option value="transporte">Transporte</option>
                            <option value="moradia">Moradia</option>
                            <option value="lazer">Lazer</option>
                            <option value="saude">Saúde</option>
                            <option value="outros">Outros</option>
                        </select>
                    </div>
                </div>

                <div class="row mb-3">
                    <div class="col-md-6">
                        <label for="dataInicio" class="form-label">Início do Alerta</label>
                        <div class="input-group">
                            <input type="date" class="form-control" id="dataInicio" name="dataInicio" required>
                            <span class="input-group-text"><i class="bi bi-calendar"></i></span>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <label for="frequencia" class="form-label">Frequência</label>
                        <select class="form-select" id="frequencia" name="frequencia" required>
                            <option value="unico">Único</option>
                            <option value="diario">Diário</option>
                            <option value="semanal">Semanal</option>
                            <option value="mensal">Mensal</option>
                        </select>
                    </div>
                </div>

                <div class="row mb-3">
                    <div class="col-md-6">
                        <label class="form-label">Canal de Envio</label>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="notificacao" name="notificacao" checked>
                            <label class="form-check-label" for="notificacao">
                                Notificação no Sistema
                            </label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="email" name="email" checked>
                            <label class="form-check-label" for="email">
                                E-mail
                            </label>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <label for="prioridade" class="form-label">Prioridade</label>
                        <select class="form-select" id="prioridade" name="prioridade" required>
                            <option value="baixa">Baixa</option>
                            <option value="media" selected>Média</option>
                            <option value="alta">Alta</option>
                        </select>
                    </div>
                </div>

                <div class="row mb-3">
                    <div class="col-md-6">
                        <div class="form-check form-switch">
                            <input class="form-check-input" type="checkbox" id="ativo" name="ativo" checked>
                            <label class="form-check-label" for="ativo">Ativar Alerta Agora</label>
                        </div>
                    </div>
                </div>

                <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                    <button type="button" class="btn btn-secondary me-md-2">Cancelar</button>
                    <button type="submit" class="btn btn-primary">
                        <i class="bi bi-bell-fill me-1"></i> Criar Alerta
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Lista de Alertas Existentes -->
    <div class="card">
        <div class="card-header">
            <h5 class="mb-0">Meus Alertas</h5>
        </div>
        <div class="card-body">
            <p class="text-muted">Nenhum alerta criado ainda.</p>
            <!-- Aqui será exibida a lista de alertas existentes -->
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
{{ super() }}
<!-- Inclui o arquivo JavaScript de alertas -->
<script src="{{ url_for('alertas.static', filename='js/alertas.js') }}"></script>

<script>
    // Inicializa tooltips
    document.addEventListener('DOMContentLoaded', function() {
        // Configura a data atual como padrão para o campo de data
        const hoje = new Date().toISOString().split('T')[0];
        document.getElementById('dataInicio').value = hoje;
        
        // Inicializa os tooltips
        var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
        tooltipTriggerList.map(function (tooltipTriggerEl) {
            return new bootstrap.Tooltip(tooltipTriggerEl);
        });
    });
</script>
{% endblock %}
